/*
Deployment script for Lab1

This code was generated by a tool.
Changes to this file may cause incorrect behavior and will be lost if
the code is regenerated.
*/

GO
SET ANSI_NULLS, ANSI_PADDING, ANSI_WARNINGS, ARITHABORT, CONCAT_NULL_YIELDS_NULL, QUOTED_IDENTIFIER ON;

SET NUMERIC_ROUNDABORT OFF;


GO
:setvar DatabaseName "Lab1"
:setvar DefaultFilePrefix "Lab1"
:setvar DefaultDataPath "F:\SQL2016DEV\MSSQL\Data\"
:setvar DefaultLogPath "F:\SQL2016DEV\MSSQL\Data\"

GO
:on error exit
GO
/*
Detect SQLCMD mode and disable script execution if SQLCMD mode is not supported.
To re-enable the script after enabling SQLCMD mode, execute the following:
SET NOEXEC OFF; 
*/
:setvar __IsSqlCmdEnabled "True"
GO
IF N'$(__IsSqlCmdEnabled)' NOT LIKE N'True'
    BEGIN
        PRINT N'SQLCMD mode must be enabled to successfully execute this script.';
        SET NOEXEC ON;
    END


GO
USE [$(DatabaseName)];


GO
PRINT N'Creating [dbo].[Canton]...';


GO
CREATE TABLE [dbo].[Canton] (
    [IdCanton]    INT           IDENTITY (1, 1) NOT NULL,
    [IdProvincia] INT           NOT NULL,
    [Descripcion] VARCHAR (250) NULL,
    CONSTRAINT [PK_Canton] PRIMARY KEY CLUSTERED ([IdCanton] ASC)
)
WITH (DATA_COMPRESSION = PAGE);


GO
PRINT N'Creating [dbo].[Distrito]...';


GO
CREATE TABLE [dbo].[Distrito] (
    [IdDistrito]  INT           IDENTITY (1, 1) NOT NULL,
    [IdCanton]    INT           NOT NULL,
    [Descripcion] VARCHAR (250) NULL,
    CONSTRAINT [PK_Distrito] PRIMARY KEY CLUSTERED ([IdDistrito] ASC)
)
WITH (DATA_COMPRESSION = PAGE);


GO
PRINT N'Creating [dbo].[EmpleadoEncuesta]...';


GO
CREATE TABLE [dbo].[EmpleadoEncuesta] (
    [IdEmpleadoEncuesta]        INT           IDENTITY (1, 1) NOT NULL,
    [FechaNacimiento]           DATE          NULL,
    [EstadoCivil]               VARCHAR (150) NOT NULL,
    [LenguajeNativo]            VARCHAR (150) NOT NULL,
    [TieneHijos]                BIT           NOT NULL,
    [CantidadHijos]             INT           NULL,
    [CantidadHijosMantiene]     INT           NULL,
    [Lee]                       BIT           NOT NULL,
    [Escribe]                   BIT           NOT NULL,
    [Carrera]                   VARCHAR (150) NOT NULL,
    [MantienePersonasAparte]    BIT           NOT NULL,
    [DesMantienePersonasAparte] VARCHAR (500) NULL,
    [IdProvincia]               INT           NOT NULL,
    [IdCanton]                  INT           NOT NULL,
    [IdDistrito]                INT           NOT NULL,
    CONSTRAINT [PK_EmpleadoEncuesta] PRIMARY KEY CLUSTERED ([IdEmpleadoEncuesta] ASC)
);


GO
PRINT N'Creating [dbo].[Provincia]...';


GO
CREATE TABLE [dbo].[Provincia] (
    [IdProvincia] INT           IDENTITY (1, 1) NOT NULL,
    [Descripcion] VARCHAR (250) NULL,
    CONSTRAINT [PK_Provincia] PRIMARY KEY CLUSTERED ([IdProvincia] ASC)
)
WITH (DATA_COMPRESSION = PAGE);


GO
PRINT N'Creating [dbo].[FK_Canton_Provincia]...';


GO
ALTER TABLE [dbo].[Canton] WITH NOCHECK
    ADD CONSTRAINT [FK_Canton_Provincia] FOREIGN KEY ([IdProvincia]) REFERENCES [dbo].[Provincia] ([IdProvincia]);


GO
PRINT N'Creating [dbo].[FK_Canton_Distrito]...';


GO
ALTER TABLE [dbo].[Distrito] WITH NOCHECK
    ADD CONSTRAINT [FK_Canton_Distrito] FOREIGN KEY ([IdCanton]) REFERENCES [dbo].[Canton] ([IdCanton]);


GO
PRINT N'Creating [dbo].[FK_EmpleadoEncuesta_Provincia]...';


GO
ALTER TABLE [dbo].[EmpleadoEncuesta] WITH NOCHECK
    ADD CONSTRAINT [FK_EmpleadoEncuesta_Provincia] FOREIGN KEY ([IdProvincia]) REFERENCES [dbo].[Provincia] ([IdProvincia]);


GO
PRINT N'Creating [dbo].[FK_EmpleadoEncuesta_Canton]...';


GO
ALTER TABLE [dbo].[EmpleadoEncuesta] WITH NOCHECK
    ADD CONSTRAINT [FK_EmpleadoEncuesta_Canton] FOREIGN KEY ([IdCanton]) REFERENCES [dbo].[Canton] ([IdCanton]);


GO
PRINT N'Creating [dbo].[FK_EmpleadoEncuesta_Distrito]...';


GO
ALTER TABLE [dbo].[EmpleadoEncuesta] WITH NOCHECK
    ADD CONSTRAINT [FK_EmpleadoEncuesta_Distrito] FOREIGN KEY ([IdDistrito]) REFERENCES [dbo].[Distrito] ([IdDistrito]);


GO
PRINT N'Checking existing data against newly created constraints';


GO
USE [$(DatabaseName)];


GO
ALTER TABLE [dbo].[Canton] WITH CHECK CHECK CONSTRAINT [FK_Canton_Provincia];

ALTER TABLE [dbo].[Distrito] WITH CHECK CHECK CONSTRAINT [FK_Canton_Distrito];

ALTER TABLE [dbo].[EmpleadoEncuesta] WITH CHECK CHECK CONSTRAINT [FK_EmpleadoEncuesta_Provincia];

ALTER TABLE [dbo].[EmpleadoEncuesta] WITH CHECK CHECK CONSTRAINT [FK_EmpleadoEncuesta_Canton];

ALTER TABLE [dbo].[EmpleadoEncuesta] WITH CHECK CHECK CONSTRAINT [FK_EmpleadoEncuesta_Distrito];


GO
PRINT N'Update complete.';


GO
